<!DOCTYPE html>
<html>
  <head>
    <title>aliernfrog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
  </head>
  <body style="background-color:black;">
    <div id="topbar" style="text-align:center;">
      <h1 id="header">aliernfrog</h1>
      <p1 id="description">Please wait..</p1><br><br>
    </div><br><br>

    <div id="bots" style="text-align:center;"></div><br><br>
    <div id="apps" style="text-align:center;"></div><br><br>

    <div id="socials" style="text-align:center;"></div>

    <script src="/assets/functions.js"></script>
    <script>
      function onConfigLoaded() {
        loadDesign();
        loadProjects();
        getWelcomeMessage();
        getSocials(document.getElementById("socials"));
      }

      function getWelcomeMessage() {
        let view = document.getElementById("description");
        if (config.welcomeWarning) {
          view.innerHTML = config.welcomeWarning;
        } else {
          view.innerHTML = randomize(config.welcomeMessages);
        }
      }

      function loadDesign() {
        document.body.style.background = config.colorBody;
        document.body.style.fontFamily = config.font;
        setBgRounded(document.getElementById("topbar"), config.colorBgPrimary);
        document.getElementById("header").style.color = config.colorText;
        document.getElementById("description").style.color = config.colorText;
        setBgRounded(document.getElementById("bots"), config.colorBgPrimary);
        document.getElementById("bots").style.color = config.colorText;
        setBgRounded(document.getElementById("apps"), config.colorBgPrimary);
        document.getElementById("apps").style.color = config.colorText;
        setBgRounded(document.getElementById("socials"), config.colorBgPrimary);
        setLinkColors(config.colorLink, []);
      }

      function loadProjects() {
        fetch("/assets/projects.json").then(async response => {
          let projects = await response.json();
          let finalBots = [];
          let finalApps = [];
          for (i = 0; i < projects.length; i++) {
            let project = projects[i];
            let redirect = "/"+project._id;
            if (project.disabled) redirect = "/";
            if (project.disabled) project.description = project.disabled;
            let str = `<a href="${redirect}" style="text-decoration:none;"><div id="${project._id}" style="text-align:center;color:${config.colorText}"><img src="${project.icon}" style="width:64px;height:64px;"><h3>${project.name}</h3><p1>${project.description}</p1></div></a>`;
            if (project.type === "bot") finalBots.push(str);
            if (project.type === "app") finalApps.push(str);
          }
          document.getElementById("bots").innerHTML = "<h2>Bots</h2>"+finalBots.join("<br>");
          document.getElementById("apps").innerHTML = "<h2>Apps</h2>"+finalApps.join("<br>");
          setDivs(document.getElementById("bots"));
          setDivs(document.getElementById("apps"));
        });
      }

      function setDivs(parent) {
        let divs = parent.getElementsByTagName("div");
        for (i = 0; i < divs.length; i++) {
          setBgRounded(divs[i], config.colorBgSecondary);
        }
      }
    </script>
  </body>
</html>